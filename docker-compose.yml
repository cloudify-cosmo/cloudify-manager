version: "3.8"

services:
  manager:
    container_name: manager
    image: cloudify-manager-aio
    volumes:
      - ../config.yaml:/etc/cloudify/config.yaml
      - ../cloudify_internal_ca_cert.pem:/tmp/cloudify_internal_ca_cert.pem
      - ../cloudify_internal_ca_key.pem:/tmp/cloudify_internal_ca_key.pem
    networks:
      - cloudify
    restart: unless-stopped

  mgmtworker:
    container_name: mgmtworker
      - .env
    networks:
      - cloudify
    restart: unless-stopped

  rest_service:
    container_name: rest_service
    build: rest-service
    env_file:
      - .env
    networks:
      - cloudify
    restart: unless-stopped

  postgresql:
    container_name: postgresql
    image: postgres
    env_file:
      - .env
    volumes:
      - ../db-schema.sql:/docker-entrypoint-initdb.d/schema.sql
    networks:
      - cloudify
    restart: unless-stopped

networks:
  cloudify:
    driver: bridge
    name: cloudify
